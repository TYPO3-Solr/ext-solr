services:
  _defaults:
    autowire: false
    autoconfigure: false

  ApacheSolrForTypo3\Solr\:
    resource: '../Classes/*'
    exclude: '../Classes/Eid/*'

  controller:
    namespace: ApacheSolrForTypo3\Solr\Controller\
    resource: '../Classes/Controller/*'
    public: true
    autowire: true
    shared: false

  viewhelper:
    namespace: ApacheSolrForTypo3\Solr\ViewHelpers\
    resource: '../Classes/ViewHelpers/*'
    public: true
    autowire: true

  query_modifier:
    namespace: ApacheSolrForTypo3\Solr\Query\Modifier\
    resource: '../Classes/Query/Modifier/*'
    public: true
    autowire: true

  backend_controller:
    namespace: ApacheSolrForTypo3\Solr\Controller\Backend\Search\
    resource: '../Classes/Controller/Backend/Search/*'
    public: true
    autowire: true
    tags: ['backend.controller']

  ApacheSolrForTypo3\Solr\Domain\Search\Uri\SearchUriBuilder:
    public: true
    autowire: true

  # BE modules, plugins
  ApacheSolrForTypo3\Solr\Backend\SettingsPreviewOnPlugins:
    arguments:
      $flexFormService: '@TYPO3\CMS\Core\Service\FlexFormService'
    tags:
      - name: event.listener
        identifier: 'solr.plugin.be.settings.preview'
        event: TYPO3\CMS\Backend\View\Event\PageContentPreviewRenderingEvent
  # END: BE modules

  viewhelper_backend:
    namespace: ApacheSolrForTypo3\Solr\ViewHelpers\Backend\
    resource: '../Classes/ViewHelpers/Backend/*'
    public: true
    autowire: true

  ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\DataUpdateHandler:
    public: true
    arguments:
      $recordService: '@ApacheSolrForTypo3\Solr\Domain\Index\Queue\RecordMonitor\Helper\ConfigurationAwareRecordService'
      $frontendEnvironment: '@ApacheSolrForTypo3\Solr\FrontendEnvironment'
      $tcaService: '@ApacheSolrForTypo3\Solr\System\TCA\TCAService'
      $indexQueue: '@ApacheSolrForTypo3\Solr\IndexQueue\Queue'
      $mountPageUpdater: '@ApacheSolrForTypo3\Solr\Domain\Index\Queue\RecordMonitor\Helper\MountPagesUpdater'
      $rootPageResolver: '@ApacheSolrForTypo3\Solr\Domain\Index\Queue\RecordMonitor\Helper\RootPageResolver'
      $pagesRepository: '@ApacheSolrForTypo3\Solr\System\Records\Pages\PagesRepository'
      $dataHandler: '@TYPO3\CMS\Core\DataHandling\DataHandler'
  ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\GarbageHandler:
    public: true
    arguments:
      $recordService: '@ApacheSolrForTypo3\Solr\Domain\Index\Queue\RecordMonitor\Helper\ConfigurationAwareRecordService'
      $frontendEnvironment: '@ApacheSolrForTypo3\Solr\FrontendEnvironment'
      $tcaService: '@ApacheSolrForTypo3\Solr\System\TCA\TCAService'
      $indexQueue: '@ApacheSolrForTypo3\Solr\IndexQueue\Queue'

  ApacheSolrForTypo3\Solr\Domain\Site\SiteHashService:
    public: true
    autowire: true

  ApacheSolrForTypo3\Solr\EventListener\EnhancedRouting\CachedUrlModifier:
    tags:
      - name: event.listener
        identifier: 'solr.routing.cachedurl-modifier'
        event: ApacheSolrForTypo3\Solr\Event\Routing\BeforeReplaceVariableInCachedUrlEvent
  ApacheSolrForTypo3\Solr\EventListener\EnhancedRouting\CachedPathVariableModifier:
    tags:
      - name: event.listener
        identifier: 'solr.routing.cachedurl-modifier'
        event: ApacheSolrForTypo3\Solr\Event\Routing\BeforeProcessCachedVariablesEvent
  ApacheSolrForTypo3\Solr\EventListener\EnhancedRouting\PostEnhancedUriProcessor:
    tags:
      - name: event.listener
        identifier: 'solr.routing.postenhanceduriprocessor-modifier'
        event: ApacheSolrForTypo3\Solr\Event\Routing\PostProcessUriEvent
  ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\EventListener\NoProcessingEventListener:
    arguments:
      $extensionConfiguration: '@ApacheSolrForTypo3\Solr\System\Configuration\ExtensionConfiguration'
      $eventDispatcher: '@Psr\EventDispatcher\EventDispatcherInterface'
    tags:
      - name: event.listener
        identifier: 'solr.index.updatehandler.noprocessingeventlistener'
        before: 'solr.index.updatehandler.immediateprocessingeventlistener,solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\ContentElementDeletedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.noprocessingeventlistener'
        before: 'solr.index.updatehandler.immediateprocessingeventlistener,solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\RecordMovedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.noprocessingeventlistener'
        before: 'solr.index.updatehandler.immediateprocessingeventlistener,solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\RecordUpdatedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.noprocessingeventlistener'
        before: 'solr.index.updatehandler.immediateprocessingeventlistener,solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\VersionSwappedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.noprocessingeventlistener'
        before: 'solr.index.updatehandler.immediateprocessingeventlistener,solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\RecordDeletedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.noprocessingeventlistener'
        before: 'solr.index.updatehandler.immediateprocessingeventlistener,solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\PageMovedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.noprocessingeventlistener'
        before: 'solr.index.updatehandler.immediateprocessingeventlistener,solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\RecordGarbageCheckEvent
  ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\EventListener\ImmediateProcessingEventListener:
    arguments:
      $extensionConfiguration: '@ApacheSolrForTypo3\Solr\System\Configuration\ExtensionConfiguration'
      $eventDispatcher: '@Psr\EventDispatcher\EventDispatcherInterface'
    tags:
      - name: event.listener
        identifier: 'solr.index.updatehandler.immediateprocessingeventlistener'
        before: 'solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\ContentElementDeletedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.immediateprocessingeventlistener'
        before: 'solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\RecordMovedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.immediateprocessingeventlistener'
        before: 'solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\RecordUpdatedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.immediateprocessingeventlistener'
        before: 'solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\VersionSwappedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.immediateprocessingeventlistener'
        before: 'solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\RecordDeletedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.immediateprocessingeventlistener'
        before: 'solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\PageMovedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.immediateprocessingeventlistener'
        before: 'solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\RecordGarbageCheckEvent
  ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\EventListener\DelayedProcessingEventListener:
    arguments:
      $extensionConfiguration: '@ApacheSolrForTypo3\Solr\System\Configuration\ExtensionConfiguration'
      $eventDispatcher: '@Psr\EventDispatcher\EventDispatcherInterface'
    tags:
      - name: event.listener
        identifier: 'solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\ContentElementDeletedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\RecordMovedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\RecordUpdatedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\VersionSwappedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\RecordDeletedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\PageMovedEvent
      - name: event.listener
        identifier: 'solr.index.updatehandler.delayedprocessingeventlistener'
        event: ApacheSolrForTypo3\Solr\Domain\Index\Queue\UpdateHandler\Events\RecordGarbageCheckEvent

  ### Indexing
  ApacheSolrForTypo3\Solr\EventListener\PageIndexer\FrontendGroupsModifier:
    tags:
      - name: event.listener
        identifier: 'solr.index.PageIndexer.FrontendUserAuthenticator'
        event: TYPO3\CMS\Frontend\Authentication\ModifyResolvedFrontendGroupsEvent
  ApacheSolrForTypo3\Solr\IndexQueue\FrontendHelper\PageIndexer:
    tags:
      - name: event.listener
        identifier: 'solr.index.FrontendHelper.PageIndexer.indexPageContentAfterCacheableContentIsGenerated'
        event: TYPO3\CMS\Frontend\Event\AfterCacheableContentIsGeneratedEvent

  ###  EXT:solr content objects
  ApacheSolrForTypo3\Solr\ContentObject\Classification:
    tags:
      - name: frontend.contentobject
        identifier: 'SOLR_CLASSIFICATION'
  ApacheSolrForTypo3\Solr\ContentObject\Content:
    tags:
      - name: frontend.contentobject
        identifier: 'SOLR_CONTENT'
  ApacheSolrForTypo3\Solr\ContentObject\Multivalue:
    tags:
      - name: frontend.contentobject
        identifier: 'SOLR_MULTIVALUE'
  ApacheSolrForTypo3\Solr\ContentObject\Relation:
    arguments:
      $tcaService: '@ApacheSolrForTypo3\Solr\System\TCA\TCAService'
    tags:
      - name: frontend.contentobject
        identifier: 'SOLR_RELATION'


  # Reports: Status
  ApacheSolrForTypo3\Solr\Report\SiteHandlingStatus:
    tags:
      - name: reports.status
  ApacheSolrForTypo3\Solr\Report\SchemaStatus:
    tags:
      - name: reports.status
  ApacheSolrForTypo3\Solr\Report\SolrConfigStatus:
    tags:
      - name: reports.status
  ApacheSolrForTypo3\Solr\Report\SolrConfigurationStatus:
    tags:
      - name: reports.status
  ApacheSolrForTypo3\Solr\Report\SolrStatus:
    tags:
      - name: reports.status
  ApacheSolrForTypo3\Solr\Report\SolrVersionStatus:
    tags:
      - name: reports.status
  ApacheSolrForTypo3\Solr\Report\AccessFilterPluginInstalledStatus:
    tags:
      - name: reports.status
  ApacheSolrForTypo3\Solr\Report\AllowUrlFOpenStatus:
    tags:
      - name: reports.status
  ApacheSolrForTypo3\Solr\Report\FilterVarStatus:
    tags:
      - name: reports.status
